<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>所有物料資料 - listAllMaterial.html</title>
<script th:src="@{/js/jquery-1.11.3.min.js}"></script>
<!-- <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script> -->

<!-- 左側jquery為table分頁用 -->
<head></head>
<style type="text/css">
table {
	/* width: 1000px; */
	background-color: white;
	margin-top: 5px;
	margin-bottom: 5px;
}

table, th, td {
	border: 1px solid #CCCCFF;
}

th, td {
	padding: 5px;
	text-align: center;
	width: 100px;
}

.center {
	margin-left: auto;
	margin-right: auto;
}

/* 以下為table分頁用 */
#pageStyle {
	display: inline-block;
	width: 32px;
	height: 32px;
	border: 1px solid #CCC;
	line-height: 32px;
	text-align: center;
	color: #999;
	margin-top: 20px;
	text-decoration: none;
}

#pageStyle:hover {
	background-color: #CCC;
}

#pageStyle .active {
	background-color: #0CF;
	color: #ffffff;
}

#center .red-text { color: red; }
#center .black-text { color: black; }
</style>
<script type="text/javascript" >
        //分頁顯示
        $(function () {
            var $table = $("table");
            var currentPage = 0; //當前頁默認值為0  
            var pageSize = 3; //每一頁顯示的數目  
            $table.bind('paging', function () {
                $table.find('tbody tr').hide().slice(currentPage * pageSize, (currentPage + 1) * pageSize).show();
            });
            var sumRows = $table.find('tbody tr').length;
            var sumPages = Math.ceil(sumRows / pageSize); //總頁數  
            document.getElementById("pageNumber").innerHTML = sumPages; //用於第114行
            
            var $pager = $('<div class="page" align="center"></div>');  //新建div，放入a標簽,顯示底部分頁碼  
            for (var pageIndex = 0; pageIndex < sumPages; pageIndex++) {
                $('<a href="#" id="pageStyle" onclick="changCss(this)"><span>' + (pageIndex + 1) + '</span></a>').bind("click", { "newPage": pageIndex }, function (event) {
                    currentPage = event.data["newPage"];
                    document.getElementById("currentPage").innerHTML = currentPage+1; //用於第114行
                    $table.trigger("paging");
                    //觸發分頁函數  
                }).appendTo($pager);
                $pager.append(" ");
            }
            $pager.insertAfter($table);
            $table.trigger("paging");

            //默認第一頁的a標簽效果  
            var $pagess = $('#pageStyle');
            $pagess[0].style.backgroundColor = "#006B00";
            $pagess[0].style.color = "#ffffff";
        });

        //a鏈接點擊變色，再點其他回復原色  
        function changCss(obj) {
            var arr = document.getElementsByTagName("a");
            for (var i = 0; i < arr.length; i++) {
                if (obj == arr[i]) {       //當前頁樣式  
                    obj.style.backgroundColor = "#006B00";
                    obj.style.color = "#ffffff";
                }
                else {
                    arr[i].style.color = "";
                    arr[i].style.backgroundColor = "";
                }
            }
            
//             function updateTableValue(pickingVO, newValue) {
//                 // Use AJAX to send a request to update the value in the server
//                 $.ajax({
//                     type: "POST",
//                     url: "/sFunction/material/updateValue", // Adjust the URL to your controller mapping
//                     data: {
//                     	id: pickingNo,
//                         newValue: newValue
//                     },
//                     success: function(response) {
//                         // Update the value in the table dynamically
//                         $("#value_" + pickingNo).text(newValue);
//                     }
//                 });
//             }
        }
        
    </script>
</head>
<body>

	<nav
		class="navbar navbar-expand-md navbar-dark bg-success fixed-top justify-content-center">
		<div align="center">
			<h2>所有物料資料 - listAllEmp.html</h2>
			<h3>
				<a class="navbar-brand" th:href="@{/sFunction/material/select_page}"><img
					th:src="@{/images/back1.gif}">回查詢頁<label th:text="${success}"></label></a>
			</h3>
		</div>
	</nav>

	<div align="center">s
		<b><font color=red>第<label id="currentPage">1</label>/<label
				id="pageNumber"></label>頁
		</font></b> <b>● 符 合 查 詢 條 件 如 下 所 示 : 共 <font color=red
			th:text="${materialListData.size}"></font> 筆
		</b>
	</div>
	<div
		style="padding: 5px; width: 1115px; height: 35px; background-color: #CCCCFF; margin-top: 5px; margin-bottom: 5px; margin-left: auto; margin-right: auto; border: 1px solid #000000;">

		<span style="padding: 15px;">物料編號</span> 
		<span style="padding: 20px;">物料名稱</span>
		<span style="padding: 25px;">物料分類編號</span>
		<span style="padding: 25px;">領料數量</span>
		<span style="padding: 25px;">庫存數量</span> 
		<span style="padding: 20px;">未入庫數量</span>
		<span style="padding: 45px;">物料單位</span> 
		<span style="padding: 20px;">安全庫存線</span>
		<span style="padding: 50px;">物料狀態</span> 
		<span style="padding: 50px;">採購需求送出日期</span>
		<span style="padding: 50px;">店家流水號</span> 
		<span style="padding: 15px;">修改</span>
	</div>

	<table id="center">
		<th:block th:each="materialVO : ${materialListData}">
				<td th:text="${materialVO.itemNumber}"></td>
				<td th:text="${materialVO.itemName}"></td>
				<td th:text="${materialVO.itemsClassVO.itemClassId} + '-[' + ${materialVO.itemsClassVO.itemClassName} + ']'"></td>
<!-- 				<td th:text="${pickingVO.pickingNo}"></td> -->
<!-- 				<td th:text="${materialVO.pickingVO.pickingQuantity}"></td> -->
<!-- 				<td id="value_${pickingVO.pickingNo}" th:text="${pickingVO.value}"></td> -->
				<td th:classappend="${materialVO.stockQuantity < materialVO.safetyStock}  ?  'red-text' : 'black-text'" th:text="${materialVO.stockQuantity}"></td>
				<td th:text="${materialVO.quantityNot}"></td>
				<td th:text="${materialVO.itemUnit}"></td>
				<td th:text="${materialVO.safetyStock}"></td>
				<td th:text="${materialVO.itemStatus}"></td>
				<td th:text="${materialVO.purDate}"></td>
				<td th:text="${materialVO.storesVO.storeId}"></td>
				
				<td>
					<form method="post"
						th:action="@{/sFunction/material/getOne_For_Update}"
						style="margin-bottom: 0px;">
						<input type="submit" value="修改"> <input type="hidden"
							name="itemNumber" th:value="${materialVO.itemNumber}">			
					</form>	
<!-- 					 <button th:attr="onclick='updateTableValue(\'' + ${{pickingVO.pickingNo} + '\', \'New Value\')'">Update</button> -->
				</td>
				
				<!-- 領料 -->
				<td>
					<form method="post"
						th:action="@{/sFunction/material/picking}"
						style="margin-bottom: 0px;">
						<input type="submit" value="領料"> <input type="hidden"
							name="itemNumber" th:value="${materialVO.itemNumber}">			
					</form>	
<!-- 					 <button th:attr="onclick='updateTableValue(\'' + ${{pickingVO.pickingNo} + '\', \'New Value\')'">Update</button> -->
				</td>
			</tr>
		</th:block>
	</table>

</body>
</html>